{{ $css := "" }}
{{ if eq (hugo.Environment) "development" -}}
  {{ $options := (dict "targetPath" "main.css" "transpiler" "libsass" "enableSourceMap" true "includePaths" (slice "node_modules" "static")) -}}
  {{ $css = resources.Get . | toCSS $options | resources.Fingerprint "sha512" -}}
{{ else -}}
  {{ $options := (dict "targetPath" "main.css" "transpiler" "libsass" "outputStyle" "compressed" "includePaths" (slice "node_modules" "static")) -}}
  {{ $css = resources.Get . | toCSS $options | postCSS (dict "config" "config/postcss.config.js") | resources.Fingerprint "sha512" -}}
{{ end -}}

{{ $inlineCSS := $css | resources.Minify }}
<style type="text/CSS">
  {{ $inlineCSS.Content | safeCSS }}
</style>


<link
  rel="preload"
  href="{{ $css.Permalink | relURL }}"
  as="style"
  integrity="{{ $css.Data.Integrity }}"
  onload="this.onload=null;this.rel='stylesheet'"
  crossorigin="anonymous" />

